generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model Player {
  id        Int      @id @default(autoincrement())
  disc_tag  String   @unique

  val_mmr   Int
  total_val_games Int @default(0)

  rl_mmr    Int
  total_rl_games Int @default(0)

  createdAt DateTime @default(now())

  games     GamePlayer[]
}

model Game {
  id        Int      @id @default(autoincrement())
  type      GameType
  winner    String?      // team key, e.g. "ATTACKING", "DEFENDING", "BLUE", "ORANGE"
  createdAt DateTime @default(now())

  players   GamePlayer[]
}


model GamePlayer {
  id        Int @id @default(autoincrement())

  gameId    Int
  playerId  Int

  team      String     // team key, interpreted by game type

  game      Game   @relation(fields: [gameId], references: [id], onDelete: Cascade)
  player    Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([gameId, playerId])
  @@index([playerId])
  @@index([gameId])
}

enum GameType {
  VAL
  RL
}
