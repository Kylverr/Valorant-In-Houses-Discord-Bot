generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model Player {
  id        Int      @id @default(autoincrement())
  disc_tag  String   @unique

  val_mmr   Int
  total_val_games Int @default(0)

  rl_mmr    Int
  total_rl_games Int @default(0)

  createdAt DateTime @default(now())

  games     ValGamePlayer[]
}

model ValGame {
  id        Int      @id @default(autoincrement())
  winner    ValTeam  @default(U)
  createdAt DateTime @default(now())

  players   ValGamePlayer[]
}

model ValGamePlayer {
  id        Int @id @default(autoincrement())

  gameId    Int
  playerId  Int

  team      ValTeam

  game      ValGame @relation(fields: [gameId], references: [id], onDelete: Cascade)
  player    Player  @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([gameId, playerId])
  @@index([playerId])
  @@index([gameId])
}

enum ValTeam {
  A
  D
  U
}
